#!/bin/bash

CUR_DIR="$( cd "$( dirname "$0" )" && pwd )"
PROTO_DIR=$CUR_DIR/../proto
AGGREGATOR_DIR=$CUR_DIR/../../messages

echo "Compiling OpenMonitor protobuf messages for Aggregator..."
protoc -I=$PROTO_DIR --python_out=$AGGREGATOR_DIR $PROTO_DIR/messages.proto

echo "Converting import statements..."
sed -i 's/from google.protobuf/from protobuf/g' $AGGREGATOR_DIR/messages_pb2.py

echo "Done!"